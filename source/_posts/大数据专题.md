---
title: 大数据专题
tags: 大数据
abbrlink: 13373
date: 2019-08-10 10:48:09
---
## 哈希函数
哈希函数又叫散列函数，输入范围很大，输出范围固定。
哈希函数的性质：
- 无限的输入域
- 输出值相同时，返回值一样
- 输入值不同时，返回值可能一样，也可能不一样
- 不同的输入值得到的hash,整体均匀分布在输出域上

1~3是哈希函数的基础，第四点是评价hash函数优劣的关键。

<!--more-->

## Map-Reduce
1. map阶段：把大任务分解为子任务
2. reduce阶段：子任务并发处理然后合并结果

注意点：
- 数据备份和容灾（需要多少备份）
- 任务分配策略和任务进度跟踪
- 多用户权限的控制

Map-Reduce统计文章单词出现的个数
![](https://i.loli.net/2019/08/10/8HSDQFfAn7uNliw.png)

## 一致性hash
**数据的归属问题**：数据经过hash计算到环上，如果在中间顺时针到离它最近的机器上
![](https://i.loli.net/2019/08/10/vleEFustc2J5mGH.png)
![](https://i.loli.net/2019/08/10/UfbxsPk8T6HW4X3.png)
例如上图：data1归属于machine2，data3归属于machine3，data3、data4归属于machine1
**机器的添加和删除**:一个机器故障，数据顺时针迁移到下一台机器上。添加新的机器的时候添加机器和它逆时针的最近机器之间的数据迁移到添加机器上。

## 常见海量处理题目的关键
- 分而治之：通过hash函数把大任务分流到机器，或者分流成小文件
- 常用hashMap或者bitMap上面

难点在对通讯、时间、空间复杂度的估计

## IPV4地址排序
**请对10亿个IPV4地址排序，每个ip出现一次**
方法：BitMap:
![](https://i.loli.net/2019/08/10/6HsKvB31w7GTd4y.png)

## 年龄排序
**10亿人的年龄排序**
方法：计数排序
![](https://i.loli.net/2019/08/10/FfkoZyeItvrN5qw.png)

## 出现内存中最多的数
**有一个包含20亿个全是32位整数的大文件，在其中找到出现次数最多的数.但是内存限制只有2G.**
哈希表方案（不可行）：
![](https://i.loli.net/2019/08/10/iPmbwZaGlUWLRx9.png)
哈希分流(可行)：
![](https://i.loli.net/2019/08/10/HhvMagYmzwRsbEi.png)

**计算：8字节x2亿 = 1.6G**

## 没出现过的数
**32位无符号整数的范围是0~4294967295。现在有一个正好包含40亿个无符号整数的文件,所以在整个范围中必然有没出现过的数。可以使用最多10M的内存，
只用找到一个没出现过的数即可，该如何找？**

hashMap方法（不可行）：
![](https://i.loli.net/2019/08/10/sQ2HklfwpB4Y7GA.png)
bitMap方法（不可行）：
![](https://i.loli.net/2019/08/10/WTrAG7pMvBwQHNd.png)
hash分流
![](https://i.loli.net/2019/08/10/nECHiFSG3gb4l1o.png)
![eLwa4g.png](https://s2.ax1x.com/2019/08/10/eLwa4g.png)


## 热词Topk
**百亿数据量的搜索词汇，设计求每天最热100词的方法**
hash分流
![eLwNE8.png](https://s2.ax1x.com/2019/08/10/eLwNE8.png)





